{
"$whitespace": ["\t", "\n", "\r", " "],
"$0-9": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"],
"$1-9": ["1", "2", "3", "4", "5", "6", "7", "8", "9"],
"$hex-digit": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9",
                  "a", "b", "c", "d", "e", "f",
                  "A", "B", "C", "D", "E", "F"],
"$exponent": ["e", "E"],
"$exponent-prefix": ["+", "-"],
"$single-char-escapes": ["\"", "\\", "/", "b", "f", "n", "r", "t"],
"$high-surrogate-2": ["8", "9", "a", "b", "A", "B"],
"$low-surrogate-2": ["c", "d", "e", "f", "C", "D", "E", "F"],


"_whitespace": {
        "$whitespace": "whitespace",
        "/": [ {"ifconfig": "comments"}, "comment-leader" ],
        "???": {"next_token": ""}
},

"comment-leader": {
        "*": "block-comment",
        "/": "line-comment",
        "...": "whitespace"
},

"block-comment": {
        "*": "uncomment-leader",
        "...": "block-comment"
},

"uncomment-leader": {
        "/": "whitespace",
        "...": "block-comment"
},

"line-comment": {
        "$newline": "whitespace",
        "...": "line-comment"
},




"*value": {
        "n": [ {"push": "null"}, "null-2"],
        "t": [ {"push": "true"}, "true-2"],
        "f": [ {"push": "false"}, "false-2"],
        "-": [ {"push": "number"}, "minus"],
        "0": [ {"push": "number"}, "zero-number"],
        "$1-9": [ {"push": "number"}, "number"],
        "\"": [ {"push": "string"}, {"push": "double-quote"}, "string" ],
        "'": [ {"ifconfig": "single-quotes"},
                [{"push": "string"}, {"push": "single-quote"}, "string"]
        ],
        "{": [ {"push": "object"}, "key" ],
        "[": [ {"push": "array"}, "value" ],
        "???": [ {"ifconfig": "unquoted-strings"}, 
                [{"push": "string"}, "string"] ]
},

"*key": {
        "\"": [ {"push": "key"}, {"push": "double-quote"}, "string" ],
        "'": [ {"ifconfig": "single-quotes"},
                [{"push": "key"}, {"push": "single-quote"}, "string"]
        ],
        "???": [ {"ifconfig": "unquoted-keys"},
                [{"push": "key"}, "string"]]
},

"*after-key": {
        ":": "value"
},

"*after-value": {
        ",": [[{"ifconfig": "trailing-commas"}, "value-or-close"], 
                "after-separator"],
        "}": [{"ifpop": "object"}, "after-value"],
        "]": [{"ifpop": "array"}, "after-value"],
        "???": [{"ifconfig": "optional-commas"}, "after-separator"]
},




"value-or-close": {
        "}": [{"ifpop": "object"}, "after-value"],
        "]": [{"ifpop": "array"}, "after-value"],
        "???": "after-separator"
},

"after-separator": {
        "???": [{"ifpeek": "object"}, "key", "value"]
},





"null-2": { "u": "null-3" },
"null-3": { "l": "null-4" },
"null-4": { "l": [{"pop": "null"}, "after-value"] },

"true-2": { "r": "true-3" },
"true-3": { "u": "true-4" },
"true-4": { "e": [{"pop": "true"}, "after-value"] },

"false-2": { "a": "false-3" },
"false-3": { "l": "false-4" },
"false-4": { "s": "false-5" },
"false-5": { "e": [{"pop": "false"}, "after-value"] },



"minus": {
        "0": "zero-number",
        "$1-9": "number"
},

"zero-number": {
        ".": "fraction",
        "$exponent": "exponent-prefix",
        "???": [{"pop": "number"}, "after-value"]
},

"number": {
        "$0-9": "number",
        ".": "fraction",
        "$exponent": "exponent-prefix",
        "???": [{"pop": "number"}, "after-value"]
},

"fraction": {
        "$0-9": "fraction",
        "$exponent": "exponent-prefix",
        "???": [{"pop": "number"}, "after-value"]
},

"exponent-prefix": {
        "$exponent-prefix": "exponent+",
        "$0-9": "exponent"
},

"exponent+": {
        "$0-9": "exponent"
},

"exponent": {
        "$0-9": "exponent",
        "???": [{"pop": "number"}, "after-value"]
},




"string": {
        "\\": [ {"push": "escape"}, 
                [{"ifconfig": "escape-characters"}, "escape-chars"], 
                "escape" ],
        "\"": [ [{"ifpop": "double-quote"}, 
                        [{"ifpop": "key"}, "after-key"], 
                        [{"ifpop": "string"}, "after-value"]],
                 "string"],
        "'": [ [{"ifpop": "single-quote"}, 
                        [{"ifpop": "key"}, "after-key"], 
                        [{"ifpop": "string"}, "after-value"]],
                "string"],
        " ": [  [ {"ifconfig": "unquoted-keys"},
                        [{"ifpop": "key"}, "after-key"]],
                [ {"ifconfig": "unquoted-strings"},
                        [{"ifpop": "string"}, "after-value"]],
                "string" ],
        "0x21-0x7F": "string",
        "0xC0-0xDF": [ {"push": "utf8"}, "1-continuation"],
        "0xE0-0xEF": [ {"push": "utf8"}, "2-continuation"],
        "0xF0-0xF7": [ {"push": "utf8"}, "3-continuation"]
},

"1-continuation": { "0x80-0xBF": [{"popx": "utf8"}, "string"] },
"2-continuation": { "0x80-0xBF": "1-continuation" },
"3-continuation": { "0x80-0xBF": "2-continuation" },

"escape": {
        "$single_char_escapes": [{"pop": "escape"}, "string"],
        "'": [ {"ifconfig": "single-quotes"}, [{"pop": "escape"}, "string"]],
        "u": "hex-1"
},

"escape-chars": {
        "...": [{"pop": "escape"}, "string"]
},

"hex-1": {
        "D": [ {"ifpeek": "surrogate" }, "low-surrogate-2", "high-surrogate-2" ],
        "$hex-digit": [{"ifnpeek": "surrogate"}, "hex-2"]
},

"high-surrogate-2": {
        "$high-surrogate-2": [ {"push": "surrogate"}, "hex-3" ],
        "$hex-digit": "hex-3"
},

"low-surrogate-2": {
        "$low-surrogate-2": [ {"popx": "surrogate"}, "hex-3" ]
},

"hex-2": { 
        "$hex-digit": "hex-3"
},

"hex-3": { 
        "$hex-digit": "hex-4"
},

"hex-4": { 
        "$hex-digit": [ 
                [{"ifpeek": "surrogate"}, "low-surrogate"],
                [{"pop": "escape"}, "string"]
        ]
},

"low-surrogate": {
        "\\": "low-surrogate-u"
},

"low-surrogate-u": {
        "u": "hex-1"
}

}




